[{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Using the ModSeqR package","text":"ModSeqR package provides basic functions importing working third-generation methylation sequencing data. vignette walk typical workflow. sequencing data coming Wasatch Biolabs (https://www.wasatchbiolabs.com/), .ch3 files delivered directly requested batch. .ch3 files contain methylation calls third-generation sequencing run. .ch3 file typically created sample within run, meant intermediate existing compress large amounts data usable form. delivered Wasatch Biolabs, .ch3 files can built using package. ’s helpful store sample CH3 files run want analyze within single directory get started.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"creating--ch3-files-from-a-tsv-optional","dir":"Articles","previous_headings":"","what":"Creating .ch3 files from a TSV (optional)","title":"Using the ModSeqR package","text":"methylation calls delimited text file (e.g., modkit extract-calls TSV), can convert compressed .ch3 archives using make_mod_archive(). dramatically reduce file size allow use ModSeqR package. make_mod_archive() reads tab-delimited calls file, selects transforms required columns, writes compressed Arrow dataset out_path using zstd compression. function derives start/end coordinates per CpG (accounting strand CG k-mer), optionally shortens long read_id’s shrink file size (short_ids = TRUE), embeds sample_name output filenames. output may sharded multiple files (e.g., SampleA-0.ch3, SampleA-1.ch3, …) depending Arrow’s writer.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"coordinate-convention","dir":"Articles","previous_headings":"Creating .ch3 files from a TSV (optional)","what":"Coordinate convention:","title":"Using the ModSeqR package","text":".ch3 files use 0-based, half-open coordinates start/end (like BED format). means start column inclusive end exclusive. Keep mind compare .ch3 positions genome browsers annotation files use 1-based inclusive coordinates (e.g., GTF/GFF). Conversion may required joining external annotations.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"expected-input-columns-typical-from-modkit","dir":"Articles","previous_headings":"Creating .ch3 files from a TSV (optional)","what":"Expected input columns (typical from modkit):","title":"Using the ModSeqR package","text":"read_id,forward_read_position, ref_position, ref_mod_strand, chrom, read_length, query_kmer, call_prob, call_code, base_qual, flag. .ch3 files written, point make_mod_db() directory containing (pass paths directly), package take care rest.","code":"# Convert a modkit TSV to a compressed .ch3 archive make_mod_archive(   file_name   = \"/path/to/modkit_calls.tsv\",  # tab-delimited input   sample_name = \"Astrocytes\",                 # used in output filenames   out_path    = \"/path/to/ch3_out\",           # directory to write .ch3 files   short_ids   = TRUE                          # shorten read_id to reduce size )  # The directory now contains e.g.: Astrocytes-0.ch3, Astrocytes-1.ch3, ... # Build a DB from those .ch3 files: make_mod_db(   ch3_files = \"/path/to/ch3_out\",   # a directory OR a vector of file paths   db_name   = \"astro_db\" )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"notes-tips","dir":"Articles","previous_headings":"Creating .ch3 files from a TSV (optional)","what":"Notes & tips","title":"Using the ModSeqR package","text":"input file contains unplaced minus-strand rows position 0 (common extract outputs), filtered automatically. already concise read IDs, set short_ids = FALSE. can run make_mod_archive() sample TSV, writing out_path; make_mod_db() can ingest whole directory one call. .ch3 files standard Parquet—fast read, compact disk, splittable parallel import.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"loading-data","dir":"Articles","previous_headings":"","what":"Loading Data","title":"Using the ModSeqR package","text":"first step workflow upload data directory holding sample sequencing data form CH3 files. files typically created Wasatch Biolabs. data obtained format, first step done using make_mod_db() function. function directly imports directory CH3 files, creates database form local file.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"make_mod_db","dir":"Articles","previous_headings":"Loading Data","what":"make_mod_db","title":"Using the ModSeqR package","text":"make_mod_db() builds DuckDB database one .ch3 Parquet files. requires two arguments: ch3_files, can directory vector file paths, db_name, path DuckDB file created (.ch3.db suffix added missing). may optionally pass named character vector assign explicit sample_names; otherwise, sample_name derived file’s basename removing trailing - (present) .ch3 extension (e.g., Astrocytes-12.ch3 → Astrocytes, M1.combined.ch3 → M1.combined). Additional filters include chrom (vector chromosomes keep), min_read_length (default 50), min_call_prob (default 0.9), min_base_qual (default 10), optional flag filter. function configures DuckDB pragmas performance (temp directory, threads ≈ --one core, memory ≈ 50% RAM), drops existing tables, creates calls table : sample_name, chrom, start, end,read_position, call_code, read_length, call_prob, base_qual, flag. example: step, database made raw calls table included. user may continue analysis direction want. may run quality control (run_mod_qc()), summarize data positions (summarize_mod_positions()), regions (summarize_mod_regions()), windows (summarize_mod_windows()). point analysis, user can export table database calling export_mod_tables(), use get_mod_table()import tibble local environment. functions explained .","code":"# Example: directory of CH3 files; auto-derived sample names ch3_files <- system.file(\"TEST_DATA\", package = \"ModSeqR\")   # adjust as needed mod_db    <- tempfile(\"example_db\") make_mod_db(ch3_files, mod_db)  # Example: explicit sample names override the fallback make_mod_db(   ch3_files = c(     sample1  = \"/data/sample1-0.ch3\",     sample2     = \"/data/sample2.ch3\"   ),   db_name   = \"named_samples\" )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"summarize_mod_positions","dir":"Articles","previous_headings":"Loading Data","what":"summarize_mod_positions","title":"Using the ModSeqR package","text":"function summarizes methylation data (calls table) unique position genome. table called “positions” built database. summarize_mod_positions() aggregates calls table genomic position sample writes positions table. always produces num_calls, , unique modification request, <label>_counts <label>_frac column (ex. methylation m_counts m_frac). control modification types via mod_code (e.g., c(“m”,“h”,“m + h”) novel “”). Labels formed removing spaces/“+” (\"m + h\" becomes mh). unmodified class defined unmod_code (default \"-\") named unmod_label (default \"c\", yielding c_counts c_frac). Optional chrs, samples, min_num_calls let filter chromosomes, samples, minimum coverage per position.","code":"# Minimal usage: default m/h classes summarize_mod_positions(mod_db)  # Custom classes, including a novel code 'a', with stricter filtering summarize_mod_positions(   mod_db,   mod_code      = c(\"a\", \"m + h\"),   unmod_code    = \"-\",   unmod_label   = \"c\",   min_num_calls = 5 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"summarize_mod_regions","dir":"Articles","previous_headings":"Loading Data","what":"summarize_mod_regions","title":"Using the ModSeqR package","text":"summarize_mod_regions() joins per-position counts annotation file regions (BED/TSV/CSV chrom, start, end, optional region_name) writes regions table. region_name missing, synthesized chrom_start_end. choose join type via join = \"inner\" | \"left\" | \"right\"; inner keeps overlapping positions/regions, left keeps regions (filling zeros appropriate), right keeps positions region matches. positions, specify set mod_code values (single combined like “m + h”), unmod_code, unmod_label, filters (chrs, samples, min_num_calls). Output columns include sample_name, region_name, chrom, start, end, num_CpGs (number positions aggregated), num_calls, <label>_counts/<label>_frac columns requested labels.","code":"region_bed = system.file(\"Islands_hg38_test.csv\", package = \"ModSeqR\") # Minimal call summarize_mod_regions(mod_db, region_file = region_bed)  # Custom call summarize_mod_regions(   mod_db,   region_file   = region_bed,   join          = \"inner\",   mod_code      = c(\"m\",\"h\",\"m + h\"),   # supports novel codes too, e.g., \"a\"   min_num_calls = 5 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"summarize_mod_windows","dir":"Articles","previous_headings":"Loading Data","what":"summarize_mod_windows","title":"Using the ModSeqR package","text":"summarize_mod_windows() produces sliding/offset windows per-position counts writes windows table. default tiles 1,000 bp windows 10 bp offsets positions assigned multiple staggered windows. output contains num_CpGs, num_calls, <label>_counts/<label>_frac requested modification labels (defined mod_code, unmod_code, unmod_label). can adjust window_size, step_size, min_num_calls, limit particular chrs samples, choose overwrite existing table. Default overwrite TRUE.","code":"# 100 bp windows, non-overlapping (step_size = window_size) summarize_mod_windows(mod_db, window_size = 100, step_size = 100)  # 2 kb windows with offsets; include a novel 'a' class summarize_mod_windows(   mod_db,   window_size   = 2000,   step_size     = 20,   mod_code      = c(\"a\", \"m + h\"),   min_num_calls = 25,   overwrite     = TRUE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"summarize_mod_reads","dir":"Articles","previous_headings":"Loading Data","what":"summarize_mod_reads","title":"Using the ModSeqR package","text":"function summarizes methylation data mod_db database reads. table called “reads” built database. 1 required arguments. mod_db list containing database file path. string representing path database, valid “ch3_db” class object. Optionally, key_table path external table can used filter unique windows interest. “chrom”, “start”, “end” column specify windows interest. reads table filtered just windows key_table.Lastly, min_CGs specifies minimum number CG sites read included. read less argument, included table.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Calculate windows summarize_mod_reads(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"convenience-utilities-inspectrenametidy","dir":"Articles","previous_headings":"","what":"Convenience utilities (inspect/rename/tidy)","title":"Using the ModSeqR package","text":"Sometimes just want peek ’s database, check table’s shape, quickly fix sample names. helpers lightweight wrappers around DuckDB/DBI exactly .","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"get_mod_dbinfo","dir":"Articles","previous_headings":"Convenience utilities (inspect/rename/tidy)","what":"get_mod_dbinfo()","title":"Using the ModSeqR package","text":"Prints quick summary database: -disk size, list tables, distinct sample_names (calls table exists). Invisibly returns closed ch3_db object.","code":"# Path or ch3_db object both work get_mod_dbinfo(\"my_data.ch3.db\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"get_mod_tableinfo","dir":"Articles","previous_headings":"Convenience utilities (inspect/rename/tidy)","what":"get_mod_tableinfo()","title":"Using the ModSeqR package","text":"Summarizes single table: total rows, per-sample row counts (table sample_name column), list columns. Good first check creating table.","code":"get_mod_tableinfo(\"my_data.ch3.db\", table_name = \"positions\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"get_mod_cols","dir":"Articles","previous_headings":"Convenience utilities (inspect/rename/tidy)","what":"get_mod_cols()","title":"Using the ModSeqR package","text":"Returns (prints) column names given table. Handy ’re write query can’t remember exact column names.","code":"get_mod_cols(\"my_data.ch3.db\", \"windows\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"get_mod_cpg_count","dir":"Articles","previous_headings":"Convenience utilities (inspect/rename/tidy)","what":"get_mod_cpg_count()","title":"Using the ModSeqR package","text":"Counts unique CpG sites table, uniqueness defined distinct (start, end) pairs. Prints small summary invisibly returns count.","code":"n_cpg <- get_mod_cpg_count(\"my_data.ch3.db\", table_name = \"calls\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"rename_mod_samples","dir":"Articles","previous_headings":"Convenience utilities (inspect/rename/tidy)","what":"rename_mod_samples()","title":"Using the ModSeqR package","text":"Renames sample_names directly specified table (e.g., positions, windows, regions, calls). provide mapping old → new names named character vector (c(old = “new”, …)) two-column data frame old new. function validates inputs, updates place, (optionally) prints /list distinct names.","code":"# Rename in the 'positions' table rename_mod_samples(   \"my_data.ch3.db\",   table       = \"positions\",   samples_map = c(\"Cortical_Neurons\" = \"Cortex\", \"Blood\" = \"PBMC\"),   preview     = TRUE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"remove_mod_table","dir":"Articles","previous_headings":"Convenience utilities (inspect/rename/tidy)","what":"remove_mod_table()","title":"Using the ModSeqR package","text":"Deletes table name exists, clear message either way (error table missing). Useful clean experiments. Tip: helpers accept either path .ch3.db file existing ch3_db object. open connection, work, close .","code":"remove_mod_table(\"my_data.ch3.db\", \"tmp_debug_table\")"},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"calc_mod_diff","dir":"Articles","previous_headings":"Differential Methylation","what":"calc_mod_diff","title":"Using the ModSeqR package","text":"function calculates differential methylation specified case control groups using various statistical methods. Differential methylation can calculated positional, regional, window methylation data. Calling function creates unique mod_diff_* table within database, differential methylation results stored. table name depends input call_type: call_type = \"positions\" → mod_diff_positions call_type = \"regions\" → mod_diff_regions call_type = \"windows\" → mod_diff_windows Calling calc_mod_diff() type data overwrite existing mod_diff_{type} table (e.g. mod_diff_windows rewritten run window data).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"automatic-choice-of-statistical-test-calc_type","dir":"Articles","previous_headings":"Differential Methylation > calc_mod_diff","what":"Automatic choice of statistical test (calc_type)","title":"Using the ModSeqR package","text":"argument calc_type controls statistical method used test differential methylation. can set manually one : \"wilcox\" – Wilcoxon rank-sum test per-sample methylation fractions \"fast_fisher\" – fast Fisher’s exact test aggregated counts \"r_fisher\" – Fisher’s exact test via base R \"log_reg\" – logistic regression–based test calc_type left NULL (default), function automatically chooses appropriate method based many samples group: calc_type set \"wilcox\" function compares distribution methylation fractions across samples groups. calc_type set \"fast_fisher\" function aggregates counts performs Fisher’s exact test resulting 2×2 contingency table. message printed indicating method chosen.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"why-this-behavior","dir":"Articles","previous_headings":"Differential Methylation > calc_mod_diff","what":"Why this behavior?","title":"Using the ModSeqR package","text":"replicates (one sample group), Wilcoxon rank-sum test preferred uses variation samples compares distributions methylation fractions across samples. better reflects biological variability. one sample per group, -sample variation model. case, collapsing counts using Fisher’s exact test appropriate statistically well-defined. can always override behavior explicitly setting calc_type .","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")    # Get methylation statistics for the 'positions' call type without plotting calc_mod_diff(mod_db = mod_db,               call_type = \"positions\",               cases = \"blood\",               controls = \"sperm\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"collapse_mod_windows","dir":"Articles","previous_headings":"Differential Methylation","what":"collapse_mod_windows","title":"Using the ModSeqR package","text":"function works mod_diff_windows table already database. differential methylation analysis called windows, collapse significant windows merging contiguous regions meet specified criteria. required parameter link database. Optionally, user may specify following arguments.max_distanceis maximum allowable distance consecutive significant windows merging (default: 1000). sig_cutoff significance threshold adjusted p-values (default: 0.05). Lastly, min_diff specifies minimum absolute methylation difference required inclusion analysis (default: 0.5).","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")    # Collapse significant windows collapse_mod_windows(\"my_data.ch3.db\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"run_mod_analysis","dir":"Articles","previous_headings":"Differential Methylation","what":"run_mod_analysis","title":"Using the ModSeqR package","text":"function automates entire workflow one command. identifies differences DNA methylation patterns two groups (cases controls) summarizing methylation data various genomic scales (positions, regions, windows) performing statistical tests, outputting results organized CSV files within one directory. run_mod_analysis() creates new subdirectory named “Mod_Diff_Analysis_Results” within out_path data written . writes three CSV files “Mod_Diff_Analysis_Results” directory directly copying tables DuckDB database: mod_diff.csv: Contains results differential analysis (e.g., p-values, fold changes) position, region, window. source table database determined diff_table_name. All_CpGs.csv: Contains summarized methylation data chosen call_type (positions, regions, windows) across samples. source table database determined call_type. Sig_CpGs.csv: Contains summarized methylation data positions/regions/windows deemed significantly differentially methylated, based p_val_max threshold.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")    # Collapse significant windows run_mod_analysis(mod_db,               out_path = \"/Users/analysis\",              call_type = \"windows\",              cases = c(\"sperm\"),              controls = c(\"blood\"))"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"quality-control","dir":"Articles","previous_headings":"","what":"Quality Control","title":"Using the ModSeqR package","text":"variety quality control functions available visually assess methylation data.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"plot_mod_cov","dir":"Articles","previous_headings":"Quality Control","what":"plot_mod_cov","title":"Using the ModSeqR package","text":"function calculates optionally plots statistics coverage data methylation sequencing experiments. can handle positional regional methylation data.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Get coverage statistics for the 'positions' call type plot_mod_cov(mod_db = mod_db, call_type = \"positions\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"plot_mod_modfrac","dir":"Articles","previous_headings":"Quality Control","what":"plot_mod_modfrac","title":"Using the ModSeqR package","text":"function retrieves calculates methylation statistics (mean methylation fractions) specified table mod database. can either return summary statistics plot histogram methylation values, depending user’s preference.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Get methylation statistics for the 'positions' call type without plotting plot_mod_modfrac(mod_db = mod_db, call_type = \"positions\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"calc_mod_samplecor","dir":"Articles","previous_headings":"Quality Control","what":"calc_mod_samplecor","title":"Using the ModSeqR package","text":"function calculates optionally plots correlation matrix methylation modification fraction data genomic positions. can handle position-based region-based calls supports visualization using ggplot2.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Run the correlation matrix function using the 'positions' call type and plot the results calc_mod_samplecor(mod_db = mod_db, call_type = \"positions\", plot = TRUE)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"plot_mod_pca","dir":"Articles","previous_headings":"Quality Control","what":"plot_mod_pca","title":"Using the ModSeqR package","text":"function performs Principal Component Analysis (PCA) methylation data retrieved database.aggregates methylation fraction data based specified call type prepares PCA analysis.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Calculate PCA plot_mod_pca(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"run_mod_qc","dir":"Articles","previous_headings":"Quality Control","what":"run_mod_qc","title":"Using the ModSeqR package","text":"Combining functions , `run_mod_qc()`` function computes QC checks methylation data time.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Calculate windows run_mod_qc(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"retrieving-and-exporting-tables","dir":"Articles","previous_headings":"","what":"Retrieving and Exporting Tables","title":"Using the ModSeqR package","text":"can access data database two different functions.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"get_mod_table","dir":"Articles","previous_headings":"Retrieving and Exporting Tables","what":"get_mod_table","title":"Using the ModSeqR package","text":"retrieve single table local environment analysis within R, using get_mod_table transform tibble store variable. Arguments required includes database, name table retrieved.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Get any table in your database and create a variable in R to work with positions = get_mod_table(\"my_data.ch3.db\", \"positions\") regions = get_mod_table(\"my_data.ch3.db\", \"regions\")  mod_diff_regions = get_mod_table(\"my_data.ch3.db\", \"mod_diff_regions\") collapsed_windows = get_mod_table(\"my_data.ch3.db\", \"collapsed_windows\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"export_mod_table","dir":"Articles","previous_headings":"Retrieving and Exporting Tables","what":"export_mod_table","title":"Using the ModSeqR package","text":"export one tables CSV file, use export_mod_table. function takes three arguments, database, tables export, path CSV files saved.","code":"# Specify the path to the database mod_db <- system.file(\"my_data.ch3.db\", package = \"ModSeqR\")   # Export the table to your computer export_mod_table(\"my_data.ch3.db\",               table = \"windows\",               out_path = \"/Desktop/My_Folder/windows.csv\")  export_mod_table(\"my_data.ch3.db\",               table = \"mod_diff_windows\",               out_path = \"/Desktop/My_Folder/mod_diff_windows.csv\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/articles/ModSeqRWalkthrough.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Using the ModSeqR package","text":"vignette, walked basic functions ModSeqR package. work work progress hope improve functionality. suggestions requested features, please email Jonathon Hill jhill@byu.edu.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonathon Hill. Author, maintainer. Hailey Zimmerman. Author.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hill J, Zimmerman H (2025). ModSeqR: Process Analyze Nanopore Sequencing Methylation Data. R package version 1.0.0, https://github.com/Wasatch-Biolabs-Bfx/ModSeqR.","code":"@Manual{,   title = {ModSeqR: Process and Analyze Nanopore Sequencing Methylation Data},   author = {Jonathon Hill and Hailey Zimmerman},   year = {2025},   note = {R package version 1.0.0},   url = {https://github.com/Wasatch-Biolabs-Bfx/ModSeqR}, }"},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"version-100","dir":"","previous_headings":"","what":"Version 1.0.0","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"(Updated December 29th 2025) Note: early release - changes may occur significantly change functionality structure data functions. user aware subsequent releases may break code written using earlier releases. ModSeqR R package managing Direct Whole Methylome Sequencing (dWMS) data. creates database, processes unique options. Data can summarized positions, windows, provided annotation bed file, unique genomic regions. package also offers quality control functions, differential methylation, sliding window analysis.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"easy visualization data management, encourage download use RStudio. RStudio download instructions can found . Linux Users: System packages may need intalled order use devtools. Instructions can found online. example guide can found .","code":"# Install the devtools package if necessary install.packages(\"devtools\")  # Install ModSeqR from GitHub devtools::install_github(\"Wasatch-Biolabs-Bfx/ModSeqR\", build_vignettes = FALSE)  # Access Package library(ModSeqR)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"creating-ch3-files","dir":"","previous_headings":"","what":"Creating .ch3 Files","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"sequencing data coming Wasatch Biolabs, .ch3 files can delivered directly batch upon request. files contain methylation calls third-generation sequencing run. Typically, one .ch3 file created per sample, file compresses large amounts raw data usable intermediate format. .ch3 files provided, can build using make_ch3_archive() function package. takes tab-delimited file methylation calls (output modkit extract-calls) compresses .ch3 format downstream use.","code":"# Convert a calls.tsv file to compressed .ch3 format make_mod_archive(   file_name   = \"calls.tsv\",   # input modkit calls file   sample_name = \"sample1\",     # will be embedded in output filenames   out_path    = \"output_dir/\", # where to write .ch3 files   short_ids   = TRUE           # optionally shorten read_id to reduce size )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"important","dir":"","previous_headings":"Creating .ch3 Files","what":"Important:","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":".ch3 files use 0-based, half-open genome coordinates (like BED files). Example: CpG base 1000 (1-based) appear start=999, end=1001. output archive written compressed Parquet format (zstd), typically producing multiple .ch3 files per sample (e.g., sample1-0.ch3, sample1-1.ch3).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"example-data","dir":"","previous_headings":"","what":"Example Data","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"’d like test package without generating .ch3 files, small example data included package : ModSeqR/inst/extdata/ch3_files/ can download example .ch3 files directly GitHub repository inst/extdata/ch3_files folder. test files can used practice building database running full analysis workflow.","code":"# Example: build a test database using included example files example_path <- system.file(\"extdata/ch3_files\", package = \"ModSeqR\") mod_db <- make_mod_db(example_path, db_name = \"example_db\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"instructions","dir":"","previous_headings":"","what":"Instructions","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"Begin .ch3 files created Wasatch Biolabs individually, build database using make_mod_db(). first hold calls table. like see key stats CH3 file, call get_mod_stats(). shows information like CpG coverage, calls flag value, high confidence calls, high quality calls, average read length.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"summarize-data","dir":"","previous_headings":"Instructions","what":"Summarize Data","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"database created, user can summarize data position (summarize_mod_positions()), regions (summarize_mod_regions()), windows (summarize_mod_windows()), reads ((summarize_mod_reads()).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"differential-methylation","dir":"","previous_headings":"Instructions","what":"Differential Methylation","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"differential methylation analysis can conducted positional, regional, window data using calc_mod_diff(). calculating methylation differences windows, use collapse_mod_windows() collapse significant windows methylation dataset. merges contiguous regions meet specified criteria.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"get-database-stats","dir":"","previous_headings":"Instructions","what":"Get Database Stats","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"like see key stats database time, including unique sample names data differential analysis, call get_mod_dbinfo(). see columns table database many records (rows) , call get_mod_tableinfo() database desired table name.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"quality-control","dir":"","previous_headings":"Instructions","what":"Quality Control","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"run_mod_qc() can called visually assess data. Running QC can take long time large data, set argument max_rows reasonable value (ex. 1000) assess data faster. view extract table, call export_table() export data table database file, use get_table() import tibble local environment. Similarily, use max_calls fine smaller, randomized set data. like run everything one command, call run_mod_analysis().","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"paradigm","dir":"","previous_headings":"","what":"Paradigm","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"can pipe functions together, feel free call function one line time. two examples . Warning - using samples human unique chromosome names, remember adjust chrs argument function!","code":"setwd(\"/home/directory/analysis\")  # Build database and run analysis in a pipe mod_db <- make_mod_db(   ch3_files = \"../ch3_files_directory\",               db_name = \"my_data\") |>   summarize_mod_windows() |>   calc_mod_diff(call_type = \"windows\",               cases =                 c(\"sperm\"),               controls =                 c(\"blood\")) |>   collapse_mod_windows()     # Build and analyze through separate lines mod_db <- make_mod_db(ch3_files = \"../ch3_files_directory\", db_name = \"my_data\") mod_db <- summarize_mod_windows(mod_db) mod_db <- calc_mod_diff(mod_db, call_type = \"windows\", cases = c(\"sperm\"), controls = c(\"blood\")) mod_db <- collapse_mod_windows(mod_db)   # Run entire differential methylation analysis in one function run_mod_analysis(mod_db,               out_path = \"/analysis\",              call_type = \"windows\",              cases = c(\"sperm\"),              controls = c(\"blood\"))  # Check to see what's in your database at any time get_mod_dbinfo(mod_db)  # Check to see the columns in any table  get_mod_tableinfo(mod_db, \"windows\")  # Export differentially methylated data to your computer export_mod_table(mod_db, \"collapsed_windows\", \"../results_directory\")  # OR, to work with your data locally in your R environment positions <- get_mod_table(mod_db, \"positions\") windows <- get_mod_table(mod_db, \"windows\") regions <- get_mod_table(mod_db, \"regions\")  #DONE! Data has been analyzed and exported!"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"convenience-functions","dir":"","previous_headings":"Paradigm","what":"Convenience Functions","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"ModSeqR also provides helper utilities make easier inspect manage database:","code":"# View all column names in a given table get_mod_cols(mod_db, \"calls\")  # Count unique CpG sites (based on start/end) get_mod_cpg_count(mod_db, table_name = \"calls\")  # Show high-level database statistics (size, tables, sample names) get_mod_dbinfo(mod_db)  # Get detailed information about a specific table get_mod_tableinfo(mod_db, \"positions\")  # Rename sample names inside any table rename_mod_samples(mod_db, \"positions\",                    samples_map = c(\"old_name\" = \"new_name\"))  # Remove a table from the database remove_mod_table(mod_db, \"temp_table\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting Help","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"see detailed documentation specific function R, call ?{function}. Example: render development documentation function Help tab Rstudio","code":"?make_mod_db()"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"vignette","dir":"","previous_headings":"Getting Help","what":"Vignette","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"get detailed instructions help working package, download view vignette github repo docs/ModSeqRWalkthrough.html. , build follow along vignette calling: R click HTML browser. , browse vignette R environment, call","code":"browseVignettes(\"ModSeqR\") vignette(\"ModSeqRWalkthrough\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Process and Analyze Nanopore Sequencing Methylation Data","text":"package distributed Personal Internal Research License (v1.1), based PolyForm Noncommercial License 1.0.0, additional grant rights internal research use provided Wasatch Biolabs. ✅ Free personal use, academic research, educational, noncommercial purposes. ✅ Commercial organizations may also use internally research evaluation. ❌ permitted commercial services, fee--service analysis, redistribution, production use. See full license text LICENSE file included repository. suggestions requested features, please email Jonathon Hill jhill@byu.edu.","code":""},{"path":[]},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/ModSeqR.html","id":null,"dir":"Reference","previous_headings":"","what":"ModSeqR: Methylation Data Analysis from Nanopore Sequencing — ModSeqR","title":"ModSeqR: Methylation Data Analysis from Nanopore Sequencing — ModSeqR","text":"ModSeqR R package developed Wasatch Biolabs efficient preprocessing, summarization, visualization methylation data. supports native DNA methylation sequencing workflows optimized high-throughput pipelines.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/ModSeqR.html","id":"features","dir":"Reference","previous_headings":"","what":"Features","title":"ModSeqR: Methylation Data Analysis from Nanopore Sequencing — ModSeqR","text":"- Database-backed storage using DuckDB - Sliding window, positional, regional, read-level summarization methylation levels - Support multiple methylation contexts - Quality Control Visualization - Efficient Differential Methylation Analysis","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/ModSeqR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ModSeqR: Methylation Data Analysis from Nanopore Sequencing — ModSeqR","text":"Wasatch Biolabs (2025). *ModSeqR: Tools Methylation Analysis Clinical Research Settings.* https://www.wasatchbiolabs.com/ bug reports feature requests: https://github.com/Wasatch-Biolabs-Bfx/ModSeqR","code":""},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/ModSeqR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ModSeqR: Methylation Data Analysis from Nanopore Sequencing — ModSeqR","text":"Jonathon Hill jonathon@wasatchbiolabs.com (aut, cre) Hailey Zimmerman hailey@renewbt.com (aut)","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Differential Methylation — calc_mod_diff","title":"Calculate Differential Methylation — calc_mod_diff","text":"function calculates differential methylation specified case control groups using various statistical methods. results stored DuckDB database analysis.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Differential Methylation — calc_mod_diff","text":"","code":"calc_mod_diff(   mod_db,   call_type = \"positions\",   output_table = NULL,   cases,   controls,   mod_type = \"mh\",   calc_type = NULL,   overwrite = TRUE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Differential Methylation — calc_mod_diff","text":"mod_db list containing database file path. valid \"mod_db\" class object. call_type string representing name table database pull data. Default \"positions\". output_table Destination table name results. NULL, defaults paste0(\"mod_diff_\", call_type). cases character vector containing sample names case group. controls character vector containing sample names control group. mod_type string indicating type modification analyze. Default \"mh\" methylation/hydroxymethylation. calc_type string specifying statistical method use calculating p-values. Options include \"wilcox\", \"fast_fisher\", \"r_fisher\", \"log_reg\". Default NULL, case \"wilcox\" used replicates either group, otherwise \"fast_fisher\" used. overwrite TRUE output_table exists, dropped writing.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Differential Methylation — calc_mod_diff","text":"list containing updated \"mod_db\" object latest tables database, including \"meth_diff\".","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_diff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Differential Methylation — calc_mod_diff","text":"function connects specified DuckDB database retrieves methylation data specified call type table. summarizes data cases controls, calculates p-values based specified method, stores results \"meth_diff\" table.","code":""},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_samplecor.html","id":null,"dir":"Reference","previous_headings":"","what":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","title":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","text":"function calculates optionally plots correlation matrix methylation modification fraction data genomic positions. supports position-based, region-based, window-based calls provides visualization using ggplot2.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_samplecor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","text":"","code":"calc_mod_samplecor(   mod_db,   call_type = c(\"positions\"),   value = m_frac,   agg_fun = mean,   plot = TRUE,   save_path = NULL,   plot_sample_order = NULL,   plot_title = \"Sample Correlation Matrix\",   max_rows = NULL )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_samplecor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","text":"mod_db string. path database containing ch3 files nanopore data. call_type character vector specifying type data retrieve database. Options \"positions\", \"regions\", \"windows\". Default \"positions\". value Column table use measurement (e.g., mh_frac, m_frac). Accepts bare column name string. Default: mh_frac. agg_fun Function used aggregate multiple rows map cell pivot (e.g., duplicates regions windows). Default: mean. plot Logical. TRUE, plot correlation heatmap. Default: TRUE. save_path Optional file path save plot. plot_sample_order Optional character vector setting sample order heatmap. plot_title Title heatmap. max_rows Optional integer randomly sample rows table faster runs.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_samplecor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","text":"Invisibly returns connection wrapper; prints correlation matrix (optionally)   ggplot heatmap.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_samplecor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","text":"function connects mod database, pulls data selected `call_type`, reshapes samples x samples matrix, computes Pearson correlations using `use = \"pairwise.complete.obs\"`. `value` column controls measurement used.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/calc_mod_samplecor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correlation Matrix of Modified Sequence Data — calc_mod_samplecor","text":"","code":"if (FALSE) { # \\dontrun{ # Use mh_frac (default) calc_mod_samplecor(mod_db = \"my_data.mod.db\", call_type = \"positions\") # Use m_frac calc_mod_samplecor(mod_db = \"my_data.mod.db\", call_type = \"regions\", value = m_frac) # Or as a string calc_mod_samplecor(mod_db = \"my_data.mod.db\", call_type = \"windows\", value = \"m_frac\") } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/classify_mod_reads.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","title":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","text":"function classifies reads `reads` table DuckDB database either `\"case\"`, `\"control\"`, `\"unknown\"` based similarity reference methylation fractions `key_table` (e.g., collapsed windows file). Classification based close read's `mh_frac` average case control `mh_frac`, within user-defined `meth_diff_threshold`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/classify_mod_reads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","text":"","code":"classify_mod_reads(   mod_db,   table_name = \"classified_reads\",   reads_table = \"reads\",   key_table,   case,   control,   meth_diff_threshold = 0.1 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/classify_mod_reads.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","text":"mod_db Path DuckDB `.db` file created package (e.g., `summarize_reads()`). table_name Character. Name output table store classified reads (default: \"classified_reads\"). reads_table Character. Name reads table want classify reads (default: \"reads\"). key_table Path CSV, TSV, BED file generated `collapse_windows()`. Must include columns: `chrom`, `start`, `end`, `avg_mh_frac_control`, `avg_mh_frac_case`, `avg_meth_diff`. case Character string used label case reads (e.g., `\"case\"`). control Character string used label control reads (e.g., `\"control\"`). meth_diff_threshold Numeric value specifying maximum difference `mh_frac` allowed match either case control averages. Must less half minimum absolute value `avg_meth_diff` prevent ambiguous classifications.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/classify_mod_reads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","text":"Invisibly returns open database connection new table named `classified_reads` added database. table includes: sample_name – Sample identifier read_id – Unique read identifier first_cpg_pos – First CpG position read last_cpg_pos – Last CpG position read mh_frac – Methylation fraction read classification – `\"case\"`, `\"control\"`, `\"unknown\"`","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/classify_mod_reads.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","text":"function runs entirely SQL scalability. performs interval join `reads` table key table `chrom` CpG position range, classifies read based proximity `mh_frac` either `avg_mh_frac_control` `avg_mh_frac_case`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/classify_mod_reads.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify Reads as Case or Control Based on Methylation Profiles — classify_mod_reads","text":"","code":"if (FALSE) { # \\dontrun{ classify_mod_reads(   mod_db = \"my_data.mod.db\",   key_table = \"key_table.csv\",   case = \"treated\",   control = \"untreated\",   meth_diff_threshold = 0.1 ) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/collapse_mod_windows.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse Windows Based on Methylation Differences — collapse_mod_windows","title":"Collapse Windows Based on Methylation Differences — collapse_mod_windows","text":"function collapses significant windows methylation dataset merging contiguous regions meet specified criteria. Can collapse windows differential modification analysis (calc_mod_diff()) called.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/collapse_mod_windows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse Windows Based on Methylation Differences — collapse_mod_windows","text":"","code":"collapse_mod_windows(   mod_db,   table_name = \"collapsed_windows\",   max_distance = 1000,   sig_cutoff = 0.05,   min_diff = 0.5 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/collapse_mod_windows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse Windows Based on Methylation Differences — collapse_mod_windows","text":"mod_db DuckDB database connection object path database. table_name Character. Name output table store collapsed windows (default: \"collapsed_windows\"). max_distance Numeric. maximum allowable distance consecutive significant windows merging (default: 1000). sig_cutoff Numeric. significance threshold adjusted p-values (default: 0.05). min_diff Numeric. minimum absolute methylation difference required inclusion analysis (default: 0.5).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/collapse_mod_windows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse Windows Based on Methylation Differences — collapse_mod_windows","text":"function return object; creates replaces         `collapsed_windows` table database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/collapse_mod_windows.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collapse Windows Based on Methylation Differences — collapse_mod_windows","text":"function performs following steps: Filters `mod_diff_windows` retain significant windows         `p_adjust <= sig_cutoff` `ABS(meth_diff) >= min_diff`. Assigns new region identifier based proximity (`max_distance`)         direction methylation differences. Collapses regions grouping contiguous windows, computing         average methylation difference (`avg_meth_diff`), counting         number merged windows.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_closeDB.html","id":null,"dir":"Reference","previous_headings":"","what":"Close Database Connection — .modhelper_closeDB","title":"Close Database Connection — .modhelper_closeDB","text":"function updates table list `mod_db` object closes database connection.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_closeDB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Close Database Connection — .modhelper_closeDB","text":"","code":".modhelper_closeDB(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_closeDB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Close Database Connection — .modhelper_closeDB","text":"mod_db object containing information database, including list tables.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_closeDB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Close Database Connection — .modhelper_closeDB","text":"None. function called side effects (updating object closing connection).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_closeDB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Close Database Connection — .modhelper_closeDB","text":"function updates `tables` attribute `mod_db` object current list tables connected database closing connection.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_connectDB.html","id":null,"dir":"Reference","previous_headings":"","what":"Connect to a Database — .modhelper_connectDB","title":"Connect to a Database — .modhelper_connectDB","text":"internal function establishes connection DuckDB database. can handle character file name object class `mod_db` open database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_connectDB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Connect to a Database — .modhelper_connectDB","text":"","code":".modhelper_connectDB(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_connectDB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Connect to a Database — .modhelper_connectDB","text":"mod_db character string representing file path DuckDB database object class `mod_db`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_connectDB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Connect to a Database — .modhelper_connectDB","text":"database connection object.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_connectDB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Connect to a Database — .modhelper_connectDB","text":"function checks class `mod_db` attempts connect database. `mod_db` character string, create object class `mod_db`. `mod_db` already class `mod_db`, directly establish connection database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_connectDB.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Connect to a Database — .modhelper_connectDB","text":"function intended internal use within package.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_purgeTables.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal Function to Purge Unwanted Tables from Database — .modhelper_purgeTables","title":"Internal Function to Purge Unwanted Tables from Database — .modhelper_purgeTables","text":"internal function connects DuckDB database removes tables specified `keep_tables` list. retains tables want keep database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_purgeTables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal Function to Purge Unwanted Tables from Database — .modhelper_purgeTables","text":"","code":".modhelper_purgeTables(db_con)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_purgeTables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal Function to Purge Unwanted Tables from Database — .modhelper_purgeTables","text":"mod_db character string object class `mod_db` representing DuckDB database connect .","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_purgeTables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal Function to Purge Unwanted Tables from Database — .modhelper_purgeTables","text":"None. function called side effects (modifying database).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/dot-modhelper_purgeTables.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal Function to Purge Unwanted Tables from Database — .modhelper_purgeTables","text":"function connects specified database, lists tables, removes included `keep_tables` vector. purging, prints names remaining tables database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/export_mod_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Export Tables from the mod Database — export_mod_table","title":"Export Tables from the mod Database — export_mod_table","text":"function exports specified tables mod database CSV files. Can export one multiple tables time. checks whether table exists database exporting, provides informative messages missing tables. output CSV files saved specified path.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/export_mod_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export Tables from the mod Database — export_mod_table","text":"","code":"export_mod_table(mod_db, table = \"positions\", out_path)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/export_mod_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export Tables from the mod Database — export_mod_table","text":"mod_db string. path database containing ch3 files nanopore data. table character vector specifying table exported database. Default \"positions\". out_path string. path directory CSV files saved. file automatically named \"table name.csv\".","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/export_mod_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export Tables from the mod Database — export_mod_table","text":"NULL. function writes specified tables CSV files.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/export_mod_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Export Tables from the mod Database — export_mod_table","text":"function connects specified database iterates list table names provided `tables` parameter. table exists database, reads table R writes CSV file location specified `out_path`. table exist database, message printed indicating . case error execution, custom error message displayed. function ensures database connection closed safely using `finally` block.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/export_mod_table.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Export Tables from the mod Database — export_mod_table","text":"function assumes tables specified `tables` exist database can accessed via `DBI` package.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/filter_mod_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a DuckDB Table and Save to a New Table — filter_mod_table","title":"Filter a DuckDB Table and Save to a New Table — filter_mod_table","text":"Applies filter conditions table DuckDB database saves result new replaced output table. done lazily using `dbplyr`, filtering translated SQL executed inside database (R).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/filter_mod_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a DuckDB Table and Save to a New Table — filter_mod_table","text":"","code":"filter_mod_table(mod_db, input_table, output_table, ...)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/filter_mod_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a DuckDB Table and Save to a New Table — filter_mod_table","text":"mod_db Path DuckDB database file (e.g., `\"my_data.mod.db\"`). input_table Name table filter. output_table Name output table create overwrite filtered results. ... Filtering expressions (e.g., `score > 0.5`, `gene_id == \"abc\"`). unquoted expressions passed directly `dplyr::filter()`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/filter_mod_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a DuckDB Table and Save to a New Table — filter_mod_table","text":"Invisibly returns path DuckDB file (invisibly).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/filter_mod_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter a DuckDB Table and Save to a New Table — filter_mod_table","text":"","code":"if (FALSE) { # \\dontrun{ filter_mod_table(mod_db = train_db,  input_table = \"collapsed_windows\",  output_table = \"collapsed_windows\", !(chrom %in% c(\"chrX\", \"chrY\"))) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Column Names from a DuckDB Table — get_mod_cols","title":"Get Column Names from a DuckDB Table — get_mod_cols","text":"Returns character vector column names specified table DuckDB database file.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Column Names from a DuckDB Table — get_mod_cols","text":"","code":"get_mod_cols(mod_db, table_name)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Column Names from a DuckDB Table — get_mod_cols","text":"mod_db Path DuckDB database file (e.g., `\"my_data.mod.db\"`). table_name Name table whose column names retrieved.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Column Names from a DuckDB Table — get_mod_cols","text":"character vector column names specified table.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cols.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Column Names from a DuckDB Table — get_mod_cols","text":"","code":"if (FALSE) { # \\dontrun{ get_mod_cols(\"my_data.mod.db\", \"windows\") } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cpg_count.html","id":null,"dir":"Reference","previous_headings":"","what":"Count unique CpG sites in a mod database table — get_mod_cpg_count","title":"Count unique CpG sites in a mod database table — get_mod_cpg_count","text":"Computes number unique CpG sites (defined distinct pairs start end positions) table calls within mod database. Accepts either file path database existing mod database object.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cpg_count.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count unique CpG sites in a mod database table — get_mod_cpg_count","text":"","code":"get_mod_cpg_count(mod_db, table_name = \"calls\")"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cpg_count.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count unique CpG sites in a mod database table — get_mod_cpg_count","text":"mod_db Character string giving path mod database file, object/handle accepted .modhelper_connectDB(). table_name Character scalar. Name table query. Defaults \"calls\".","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cpg_count.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count unique CpG sites in a mod database table — get_mod_cpg_count","text":"integer (length-one) giving number unique CpG sites,   returned invisibly. table_name exist, returns   NULL invisibly printing message. function also prints   formatted summary console side effect.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cpg_count.html","id":"errors","dir":"Reference","previous_headings":"","what":"Errors","title":"Count unique CpG sites in a mod database table — get_mod_cpg_count","text":"mod_db character path file exist, error thrown stop() attempting connection.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_cpg_count.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count unique CpG sites in a mod database table — get_mod_cpg_count","text":"","code":"if (FALSE) { # \\dontrun{ # Using a file path n <- get_mod_cpg_count(\"/path/to/my.mod.db\", table_name = \"calls\") n  # Using a pre-opened handle (package-internal) dbh <- .modhelper_connectDB(\"/path/to/my.mod.db\") get_mod_cpg_count(dbh)              # prints summary, returns value invisibly } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_dbinfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Database Statistics — get_mod_dbinfo","title":"Get Database Statistics — get_mod_dbinfo","text":"Prints summary mod database, including size, tables, unique sample names.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_dbinfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Database Statistics — get_mod_dbinfo","text":"","code":"get_mod_dbinfo(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_dbinfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Database Statistics — get_mod_dbinfo","text":"mod_db Path `.mod.db` file `mod_db` object.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_dbinfo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Database Statistics — get_mod_dbinfo","text":"Invisibly returns list stats database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_dbinfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Database Statistics — get_mod_dbinfo","text":"","code":"# Specify the path to the database  mod_db <- system.file(\"my_data.mod.db\", package = \"MethylSeqR\")    # Get database statistics  get_mod_dbinfo(mod_db = mod_db) #> Error in get_mod_dbinfo(mod_db = mod_db): The database file  does not exist."},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Statistics for a Ch3 File — get_mod_stats","title":"Compute Statistics for a Ch3 File — get_mod_stats","text":"function computes various statistics given Ch3 file stored Parquet format, including total calls, total reads, mean read length, CpG coverage different read thresholds, flag distributions, high-quality call counts based probability base quality thresholds.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Statistics for a Ch3 File — get_mod_stats","text":"","code":"get_mod_stats(   ch3_file,   log_file = NULL,   min_reads = c(1, 5, 10, 15),   call_prob_threshold = 0.9,   base_qual_threshold = 10,   silently = FALSE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Statistics for a Ch3 File — get_mod_stats","text":"ch3_file Character. Path Ch3 file Parquet format. log_file Character (optional). Path log file output written. NULL, results printed console. min_reads Numeric vector. set thresholds reporting CpG coverage different minimum read counts. Default: c(1, 5, 10, 15). call_prob_threshold Numeric. minimum modification probability consider high-confidence call. Default: 0.9. base_qual_threshold Numeric. minimum base quality required count high-quality call. Default: 10. silently Logical. TRUE, suppresses console output. Default: FALSE.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Statistics for a Ch3 File — get_mod_stats","text":"list containing: num_calls Total number modification calls file. num_reads Total number unique reads file. cpg_coverage matrix CpG coverage counts different   min_reads thresholds. flag_counts data frame count percentage   calls per flag value. high_conf_calls data frame count percentage   calls modification probability call_prob_threshold. high_qual_calls data frame count percentage   calls base quality base_qual_threshold. avg_read_length mean read length.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_stats.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Statistics for a Ch3 File — get_mod_stats","text":"function reads Ch3 file dataset computes basic statistics calls reads. also evaluates CpG coverage based different read count thresholds, distributions flag values, counts high-quality calls based user-defined probability quality thresholds. log_file provided, results written . Otherwise, printed console unless silently = TRUE.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Statistics for a Ch3 File — get_mod_stats","text":"","code":"if (FALSE) { # \\dontrun{ get_mod_stats(\"example.ch3.parquet\") get_mod_stats(\"example.ch3.parquet\", log_file = \"stats.log\", silently = TRUE) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Collect Table from DuckDB Database as Tibble — get_mod_table","title":"Collect Table from DuckDB Database as Tibble — get_mod_table","text":"function connects DuckDB database collects specified table tibble.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collect Table from DuckDB Database as Tibble — get_mod_table","text":"","code":"get_mod_table(mod_db, table_name, max_rows = NULL)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collect Table from DuckDB Database as Tibble — get_mod_table","text":"mod_db list containing database file path. valid \"mod_db\" class object. table_name string representing name table collect database. max_rows maximum amount rows wanted calculation. argument can help analysis run faster lot data.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collect Table from DuckDB Database as Tibble — get_mod_table","text":"tibble containing collected data specified database table. table retrieval fails, empty tibble returned.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collect Table from DuckDB Database as Tibble — get_mod_table","text":"function establishes connection DuckDB database using .helper_connectDB. retrieves specified table tibble. error occurs table retrieval, message error displayed. database connection closed retrieving data, regardless success failure.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collect Table from DuckDB Database as Tibble — get_mod_table","text":"","code":"# Assuming mod_db is a valid database object and \"positions\" is a table in the database mod_db <- system.file(\"my_data.mod.db\", package = \"ModSeqR\") positions = get_mod_table(mod_db, \"positions\") #> Table 'positions' does not exist in the database."},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_tableinfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Table Information from mod Database — get_mod_tableinfo","title":"Get Table Information from mod Database — get_mod_tableinfo","text":"Provides summary specified table within `.mod.db` database, including total number records, sample-level record counts (applicable), column names.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_tableinfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Table Information from mod Database — get_mod_tableinfo","text":"","code":"get_mod_tableinfo(mod_db, table_name)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_tableinfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Table Information from mod Database — get_mod_tableinfo","text":"mod_db Path `.mod.db` file `mod_db` object. table_name Name table summarize.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_tableinfo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Table Information from mod Database — get_mod_tableinfo","text":"Invisibly returns closed `mod_db` object summarizing specified table.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/get_mod_tableinfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Table Information from mod Database — get_mod_tableinfo","text":"","code":"# Specify the path to the database mod_db <- system.file(\"my_data.mod.db\", package = \"ModSeqR\")  # Get information about the 'calls' table get_mod_tableinfo(mod_db = mod_db, table_name = \"calls\") #> Error in get_mod_tableinfo(mod_db = mod_db, table_name = \"calls\"): The database file   does not exist."},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_archive.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","title":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","text":"Reads delimited methylation call file writes compressed archive format. Useful standardizing compressing methylation data across multiple samples.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_archive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","text":"","code":"make_mod_archive(file_name, sample_name, out_path, short_ids = TRUE)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_archive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","text":"file_name Path input file (tab-delimited) containing methylation calls. sample_name Name sample embed output archive filenames. out_path Output directory `.ch3` files written. short_ids Logical; default `TRUE`, shortens `read_id` trimming prefixes reduce file size.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_archive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","text":"(Invisibly) path template output archive files. Also prints message timing information.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_archive.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","text":"input file contain specific columns `read_id`, `chrom`, `ref_position`, `ref_mod_strand`, `query_kmer`, `call_prob`, `call_code`, `base_qual`, `flag`. function filters unplaced '-' strand reads position 0, adds new fields like `start` `end`, writes result compressed Arrow dataset `zstd` compression.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_archive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Compressed Methylation Call Archive (.ch3) from a calls file. — make_mod_archive","text":"","code":"if (FALSE) { # \\dontrun{ make_mod_archive(\"calls.tsv\", \"sample1\", \"output/\", short_ids = TRUE) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"Build DuckDB database containing filtered modification call data one .ch3 parquet files. Inputs may individual files, directories (expanded *.ch3 files), **named character vector** names used sample_names output.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"","code":"make_mod_db(   ch3_files,   db_name,   chrom = NULL,   min_read_length = 50,   min_call_prob = 0.9,   min_base_qual = 10,   flag = NULL )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"ch3_files Character vector CH3 parquet file paths /directories. May named vector assign sample_names explicitly; entry form NAME=PATH also accepted. Directories scanned (non-recursively) *.ch3 files. Must empty. db_name Path (without .mod.db extension) DuckDB database created; .mod.db appended missing. chrom Optional chromosome filter. Either single string (e.g., \"chr1\") character vector (e.g., c(\"chr1\",\"chr2\",\"chrX\")). NULL, chromosomes included. min_read_length Minimum read length keep (default 50). min_call_prob Minimum call probability keep (default 0.9). min_base_qual Minimum base quality keep (default 10). flag Optional numeric flag value require; NULL, flag filter.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"(Invisibly) list class \"mod_db\" elements: db_file: path created DuckDB file, current_table: NULL (set downstream functions), con: connection closed cleanup set \"none\". database contains least calls table.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"Expands ch3_files (handling directories named entries) mapping         source files optional sample_names. Configures DuckDB pragmas temp directory, thread count (--one core),         memory limit (~50 Drops existing tables target DB. Reads input .ch3 parquet files single pass creates         table calls columns:         sample_name, chrom, start, end, read_position,         call_code, read_length, call_prob, base_qual, flag.         names given inputs, sample_name defaults file stem. Applies pushdown filters based chrom, min_read_length,         min_call_prob, min_base_qual, flag. Side effects performance Creates (overwrites) DuckDB file db_name. Uses temp directory DuckDB spills tempdir(). temporary -memory table file_map may created input mapping.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":"input-forms","dir":"Reference","previous_headings":"","what":"Input forms","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"Files: c(\".ch3\", \"b.ch3\") Directories: c(\"dir_of_ch3s/\") (expands *.ch3) Named files/dirs: c(SampleA = \".ch3\", SampleB = \"dir/\")         — names become sample_name. name provided,         filename stem (without .ch3) used.","code":""},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/make_mod_db.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Modifications DuckDB from Parquet CH3 files (with optional sample naming) — make_mod_db","text":"","code":"if (FALSE) { # \\dontrun{ # 1) Directory of CH3 files (non-recursive scan for *.ch3) make_mod_db(ch3_files = \"path/to/ch3_dir\",             db_name   = \"my_db\")  # 2) Explicit files (auto-sample names from stems) make_mod_db(ch3_files = c(\"A.ch3\", \"B.ch3\"),             db_name   = \"two_samples.mod.db\",             min_read_length = 100, min_base_qual = 10)  # 3) Named inputs (sample_name set from names) make_mod_db(   ch3_files = c(     Sample1      = \"../CH3/Sample1.ch3\",     Sample2  = \"../CH3/Sample2.ch3\"   ),   db_name = \"My_DB\",   min_base_qual = 10,   min_read_length = 100 )  # 4) Filter to specific chromosomes make_mod_db(   ch3_files = c(S1 = \"A.mod\", S2 = \"B.mod\"),   db_name   = \"chr1_chrX_only\",   chrom     = c(\"chr1\",\"chrX\") ) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate and Plot Coverage Statistics — plot_mod_cov","title":"Calculate and Plot Coverage Statistics — plot_mod_cov","text":"function calculates optionally plots statistics coverage data methylation sequencing experiments. can handle positional regional methylation data.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate and Plot Coverage Statistics — plot_mod_cov","text":"","code":"plot_mod_cov(   mod_db,   call_type = \"positions\",   plot = TRUE,   save_path = NULL,   max_rows = NULL )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate and Plot Coverage Statistics — plot_mod_cov","text":"mod_db data base either linking file name class mod_db. call_type Either positions regions data analyze coverage . plot Logical, TRUE, function generate histogram coverage data. Default FALSE. save_path Pathway save plot . Usually .pdf .png. max_rows maximum amount rows wanted calculation. argument can help analysis run faster lot data.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate and Plot Coverage Statistics — plot_mod_cov","text":"plot FALSE, function prints summary statistics percentiles coverage data. plot TRUE, prints histogram log-transformed coverage data.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_cov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate and Plot Coverage Statistics — plot_mod_cov","text":"","code":"# Specify the path to the database  mod_db <- system.file(\"my_data.mod.db\", package = \"ModSeqR\")    # Get coverage statistics for the 'positions' call type without plotting  plot_mod_cov(mod_db = mod_db, call_type = \"positions\") #> Error in plot_mod_cov(mod_db = mod_db, call_type = \"positions\"): positions Table does not exist in the database. Check spelling or make sure you create it first."},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Differential Methylation Volcano Raster — plot_mod_diff","title":"Plot Differential Methylation Volcano Raster — plot_mod_diff","text":"Creates volcano-style raster plot differential methylation results using database-backed plotting via `dbplot`. function connects DuckDB database, retrieves specified differential methylation table, filters transforms data, generates raster plot `meth_diff` x-axis `-log10(p-value)` y-axis.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Differential Methylation Volcano Raster — plot_mod_diff","text":"","code":"plot_mod_diff(mod_db, table)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Differential Methylation Volcano Raster — plot_mod_diff","text":"mod_db `mod_db` object character string representing file path DuckDB database. database must contain table differential methylation results. table character string specifying name table database containing differential methylation data. table must contain least following columns: `meth_diff` `p_val`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Differential Methylation Volcano Raster — plot_mod_diff","text":"Invisibly returns `mod_db` object closing database connection. function prints ggplot2 raster plot active R graphics device.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Differential Methylation Volcano Raster — plot_mod_diff","text":"plot uses `dbplot::dbplot_raster()` efficiently create raster visualization large-scale methylation difference data. applies log10 transformation `p_val` column uses color gradient show density observations bin. message printed indicate time taken generate plot.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Differential Methylation Volcano Raster — plot_mod_diff","text":"","code":"if (FALSE) { # \\dontrun{ plot_mod_diff(\"my_methylation.mod.db\", \"mod_diff_windows\") } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","title":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","text":"function generates scatter plot methylation fractions case vs control samples modification DuckDB database table, optional density shading threshold lines.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","text":"","code":"plot_mod_diff_density(   mod_db,   table,   thresh = c(0.2, 0.3),   palette = \"turbo\",   n_kde = 250 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","text":"mod_db path modification DuckDB database, open database connection object. table string specifying table name within database, containing `mh_frac_case` `mh_frac_control` columns. thresh numeric vector length 1 2 giving positive negative threshold values draw dashed red lines identity line (default `c(0.2, 0.3)`). `NULL`, threshold lines drawn. palette string specifying viridis color palette density shading (default `\"turbo\"`). options include `\"viridis\"`, `\"plasma\"`, `\"cividis\"`, etc. size numeric value controlling point size plot (default `0.8`).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff_density.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","text":"Invisibly returns closed database connection object. plot printed current graphics device.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff_density.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","text":"function visualizes relationship `mh_frac_case` `mh_frac_control` methylation values plotting scatter plot. optionally enhances visualization local point density using `ggpointdensity` package available. Features: ggpointdensity installed, point density used color points. installed, fallback plain transparent points used. solid black identity line (`y = x`) added reference. Optional threshold lines ±`thresh` distance identity line shown red dashed lines. plot limited [0, 1] range axes uses clean classic theme.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_diff_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Case vs Control Methylation Fractions with Density-Weighted Points — plot_mod_diff_density","text":"","code":"if (FALSE) { # \\dontrun{ plot_mod_diff_density(\"my_data/my.mod.db\", table = \"chr5\", thresh = c(0.25, 0.35)) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"function retrieves calculates methylation statistics (mean methylation fractions) specified table mod database. can either return summary statistics plot histogram methylation values, depending user's preference.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"","code":"plot_mod_modfrac(   mod_db,   call_type = c(\"positions\", \"regions\"),   plot = TRUE,   save_path = NULL,   max_rows = NULL )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"mod_db string. path database containing mod files nanopore data. call_type character vector specifying type data retrieve database. Default \"positions\". Can also \"regions\". plot logical value. TRUE, histogram methylation values plotted. Default FALSE. save_path Pathway save plot . Usually .pdf .png. max_rows maximum amount rows wanted calculation. argument can help analysis run faster lot data.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"`plot` FALSE, function prints summary methylation statistics quantiles. `plot` TRUE, displays histogram methylation values.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"function connects specified database, checks existence relevant table, retrieves methylation fraction data. table contains methylation data, prioritizes `mh_frac` column others. Depending `call_type`, can compute statistics either per base per region. `plot` set TRUE, generates histogram methylation values.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"function assumes database tables named according `call_type` parameter (e.g., \"positions\", \"regions\"). also expects specific columns methylation data exist.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_modfrac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Methylation Statistics from the Modifications Database — plot_mod_modfrac","text":"","code":"# Specify the path to the database  mod_db <- system.file(\"my_data.mod.db\", package = \"ModSeqR\")    # Get methylation statistics for the 'positions' call type without plotting  plot_mod_modfrac(mod_db = mod_db, call_type = \"positions\") #> Error in plot_mod_modfrac(mod_db = mod_db, call_type = \"positions\"): positions Table does not exist in the database. Check spelling or make sure you create it first."},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_pca.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform PCA on Methylation Data — plot_mod_pca","title":"Perform PCA on Methylation Data — plot_mod_pca","text":"function performs Principal Component Analysis (PCA) methylation () data retrieved DuckDB database. aggregates chosen value column based specified call type prepares PCA analysis.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_pca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform PCA on Methylation Data — plot_mod_pca","text":"","code":"plot_mod_pca(   mod_db,   call_type = \"positions\",   value = m_frac,   save_path = NULL,   max_rows = NULL )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_pca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform PCA on Methylation Data — plot_mod_pca","text":"mod_db list containing database file path. valid \"mod_db\" class object. call_type string representing name table database pull data. Default \"positions\". value Column use measurement PCA (e.g., `mh_frac`, `m_frac`). Accepts bare column name single string. Default: `m_frac`. save_path Path save plot (e.g., .pdf .png). NULL, plot saved. max_rows Optional maximum number rows sample table (speed large datasets).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_pca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform PCA on Methylation Data — plot_mod_pca","text":"Produces PCA plot (PC1 vs PC2) prints PCA summary PCA scores.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_pca.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Perform PCA on Methylation Data — plot_mod_pca","text":"function connects specified DuckDB database, retrieves data `call_type`, reshapes features × samples matrix (features regions/windows/positions; columns samples), scales features, runs PCA samples (transpose `prcomp`).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/plot_mod_pca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform PCA on Methylation Data — plot_mod_pca","text":"","code":"if (FALSE) { # \\dontrun{ # Default (m_frac)  plot_mod_pca(mod_db)  # Use mh_frac instead  plot_mod_pca(mod_db, call_type = \"regions\", value = mh_frac)  # Or as a string  plot_mod_pca(mod_db, call_type = \"windows\", value = \"mh_frac\") } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/print.mod_db.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper Function to Print Database Tables — print.mod_db","title":"Helper Function to Print Database Tables — print.mod_db","text":"function connects DuckDB database prints names tables currently database. can also print first rows specific tables.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/print.mod_db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper Function to Print Database Tables — print.mod_db","text":"","code":"# S3 method for class 'mod_db' print(mod_db)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/print.mod_db.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper Function to Print Database Tables — print.mod_db","text":"mod_db character string object class mod_db representing DuckDB database connect . tables character vector specifying names tables print. Defaults last table given, print tables. specific table names provided, print (ex. \"positions\", \"regions\", \"meth_diff\"). tables =\"\", function print table sin database...","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/print.mod_db.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper Function to Print Database Tables — print.mod_db","text":"None. function called side effects (printing information).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/print.mod_db.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Helper Function to Print Database Tables — print.mod_db","text":"function establishes connection database, retrieves list tables, prints names. specified table exists, also prints first rows table. specified table exist, message printed indicate .","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/print.mod_db.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Helper Function to Print Database Tables — print.mod_db","text":"","code":"# Specify the path to the database  mod_files <- system.file(\"test_data\", package = \"MethylSeqR\")  mod_db <- tempfile(\"example_db\")    # Print out tables in the database  make_pos_db(mod_files, mod_db) |> print() #> Error in make_pos_db(mod_files, mod_db): could not find function \"make_pos_db\""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/remove_mod_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove a table from a database connection. — remove_mod_table","title":"Remove a table from a database connection. — remove_mod_table","text":"function checks table exists , , removes . provides messages outcome.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/remove_mod_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove a table from a database connection. — remove_mod_table","text":"","code":"remove_mod_table(mod_db, table_name)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/remove_mod_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove a table from a database connection. — remove_mod_table","text":"mod_db database object. table_name string specifying name table remove.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/remove_mod_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove a table from a database connection. — remove_mod_table","text":"Invisibly returns database removed table.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/rename_mod_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename sample names in a table — rename_mod_samples","title":"Rename sample names in a table — rename_mod_samples","text":"Update sample_name values specified DuckDB table using mapping old names new names. Accepts either named character vector (c(old=\"new\", ...)), two-column data.frame columns old new.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/rename_mod_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename sample names in a table — rename_mod_samples","text":"","code":"rename_mod_samples(mod_db, table, samples_map, strict = TRUE, preview = TRUE)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/rename_mod_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename sample names in a table — rename_mod_samples","text":"mod_db Path .mod.db file \"mod_db\" object. table Character scalar: table modify (e.g. \"positions\", \"windows\", \"regions\", \"calls\"). samples_map Either named character vector (names = old, values = new) data.frame columns old new. strict Logical; TRUE (default) stop issues (missing old names, empty/NA new names, duplicate mappings). FALSE, tries proceed dropping invalid rows warning. preview Logical; TRUE, prints small /summary distinct sample names.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/rename_mod_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename sample names in a table — rename_mod_samples","text":"(Invisibly) updated \"mod_db\" object (connection closed return).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/rename_mod_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename sample names in a table — rename_mod_samples","text":"","code":"if (FALSE) { # \\dontrun{ # Named character vector rename_mod_samples(\"my_db.mod.db\", table = \"positions\",                    samples_map = c(\"Astrocytes\" = \"Astro\",                                    \"Cortical_Neurons\" = \"Cortical\"))  # data.frame mapping m <- data.frame(old = c(\"Ctrl1\",\"Ctrl2\"), new = c(\"Control_1\",\"Control_2\")) rename_mod_samples(\"my_db.mod.db\", \"windows\", m) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Differential Analysis on Methylation Data — run_mod_analysis","title":"Run Differential Analysis on Methylation Data — run_mod_analysis","text":"function performs differential analysis methylation data based specified call type applies appropriate summarization method. supports analysis positions, regions, windows. function handles summarization methylation data performs differential modification analysis based case-control comparisons.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Differential Analysis on Methylation Data — run_mod_analysis","text":"","code":"run_mod_analysis(   mod_db,   out_path,   call_type,   region_file = NULL,   window_size = 1000,   step_size = 10,   cases,   controls,   mod_type = \"mh\",   calc_type = \"fast_fisher\",   p_val_max = 0.05 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Differential Analysis on Methylation Data — run_mod_analysis","text":"mod_db `mod_db` object representing DuckDB database containing methylation data. database include necessary tables analysis, positions, regions, windows. out_path directory \"Mod_Diff_Analysis_Results\" directory containing result data written . user provide directory, working directory used. call_type character string specifying type data analyze. Must one : \"positions\", \"regions\", \"windows\". determines summarization approach use. region_file character string specifying path region annotation file (required `call_type` `\"regions\"`). file supported format (e.g., BED, CSV, TSV). window_size integer specifying window size summarizing methylation data `call_type` `\"windows\"`. default value 1000. step_size integer specifying step size sliding windows `call_type` `\"windows\"`. default value 10. cases character vector sample names used cases differential analysis. argument required NULL. controls character vector sample names used controls differential analysis. argument required NULL. mod_type character string specifying modification type analyze. default `\"mh\"`, includes methylation hydroxymethylation. options `\"c\"` unmodified cytosine, `\"m\"` methylation, `\"h\"` hydroxymethylation. calc_type character string specifying type statistical test use differential analysis. default `\"fast_fisher\"`, calculation methods can implemented. p_val_max p value threshold significant differentially modified positions/regions/windows written final directory.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Differential Analysis on Methylation Data — run_mod_analysis","text":"result differential analysis, typically form table data frame   calculated statistics p-values position, region, window, depending `call_type`.   result printed console.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_analysis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run Differential Analysis on Methylation Data — run_mod_analysis","text":"function first summarizes methylation data specified call type (positions, regions, windows). proceeds differential modification analysis provided case control samples. analysis tailored based selected modification type (`mod_type`) calculation method (`calc_type`).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_dplyr.html","id":null,"dir":"Reference","previous_headings":"","what":"Execute an Expression on a DuckDB Table with Optional Materialization — run_mod_dplyr","title":"Execute an Expression on a DuckDB Table with Optional Materialization — run_mod_dplyr","text":"Connects DuckDB database, evaluates user-supplied expression specified table, either collects result R computes stores new table database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_dplyr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Execute an Expression on a DuckDB Table with Optional Materialization — run_mod_dplyr","text":"","code":"run_mod_dplyr(   mod_db,   table_name,   expr,   mode = c(\"collect\", \"compute\"),   output_table = NULL )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_dplyr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Execute an Expression on a DuckDB Table with Optional Materialization — run_mod_dplyr","text":"mod_db Path DuckDB database file (e.g., `\"my_data.mod.db\"`). table_name Name table database operate . expr function taking one argument (`tbl_ref`) returning lazy `dplyr` expression. table reference (`tbl_ref`) passed `tbl()` object connected database. mode One `\"collect\"` (default) `\"compute\"`. `\"collect\"`, result returned data frame R. `\"compute\"`, result stored new table database. output_table Required `mode = \"compute\"`. Name output table create overwrite result `expr(tbl_ref)`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_dplyr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Execute an Expression on a DuckDB Table with Optional Materialization — run_mod_dplyr","text":"`mode = \"collect\"`, returns data frame. `mode = \"compute\"`, returns `NULL` invisibly.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_dplyr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Execute an Expression on a DuckDB Table with Optional Materialization — run_mod_dplyr","text":"","code":"if (FALSE) { # \\dontrun{ # Collect results of a filtered table into R run_mod_dplyr(   mod_db = \"my_data.mod.db\",   table_name = \"methylation_data\",   expr = function(tbl_ref) dplyr::filter(tbl_ref, score > 0.5),   mode = \"collect\" )  # Store the filtered result in a new table inside the database run_mod_dplyr(   mod_db = \"my_data.mod.db\",   table_name = \"methylation_data\",   expr = function(tbl_ref) dplyr::filter(tbl_ref, score > 0.5),   mode = \"compute\",   output_table = \"filtered_data\" ) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_qc.html","id":null,"dir":"Reference","previous_headings":"","what":"Quality Control Wrapper for Methylation Data — run_mod_qc","title":"Quality Control Wrapper for Methylation Data — run_mod_qc","text":"function serves wrapper various quality control analyses methylation data. sequentially calculates coverage statistics, modification statistics, correlation analysis, performs principal component analysis (PCA).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_qc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quality Control Wrapper for Methylation Data — run_mod_qc","text":"","code":"run_mod_qc(   mod_db,   call_type = \"positions\",   plot = TRUE,   max_rows = NULL,   value = m_frac )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_qc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quality Control Wrapper for Methylation Data — run_mod_qc","text":"mod_db database connection object containing methylation data. call_type character string indicating type call retrieve data (e.g., \"positions\", \"regions\"). plot Logical; whether generate plots. Defaults TRUE. max_rows Optional maximum number rows use (sampling) speed large datasets. value Column use analyses take value input (e.g., correlations/PCA). Accepts bare column name string. Default: m_frac.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_qc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quality Control Wrapper for Methylation Data — run_mod_qc","text":"Invisibly returns nothing; produces plots console output.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_qc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quality Control Wrapper for Methylation Data — run_mod_qc","text":"","code":"if (FALSE) { # \\dontrun{  mod_db <- system.file(\"my_data.mod.db\", package = \"MethylSeqR\")  run_mod_qc(mod_db, call_type = \"positions\")                 # uses m_frac  run_mod_qc(mod_db, call_type = \"regions\", value = mh_frac)  # use mh_frac } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_sql.html","id":null,"dir":"Reference","previous_headings":"","what":"Execute a query on a mod Database — run_mod_sql","title":"Execute a query on a mod Database — run_mod_sql","text":"Connects DuckDB database, evaluates user-supplied sql query closes database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_sql.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Execute a query on a mod Database — run_mod_sql","text":"","code":"run_mod_sql(mod_db, query)"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_sql.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Execute a query on a mod Database — run_mod_sql","text":"mod_db Path DuckDB database file (e.g., `\"my_data.mod.db\"`). query sql query supported duckdb database framework.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_sql.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Execute a query on a mod Database — run_mod_sql","text":"mod_db object allow piping","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/run_mod_sql.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Execute a query on a mod Database — run_mod_sql","text":"","code":"if (FALSE) { # \\dontrun{ # Count the number of rows in the calls table run_mod_sql(   mod_db = \"my_data.mod.db\",   query = \"CREATE TABLE call_count AS SELECT COUNT(*) AS num_rows FROM calls;\") } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"Aggregates row-level mod calls (input_table, typically \"calls\") per-sample, per-genomic-position table (output_table, default \"positions\"). Counts fractions created unmodified class set user-defined modification codes /combinations (e.g., \"m\", \"h\", \"m + h\", \"\").","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"","code":"summarize_mod_positions(   mod_db,   input_table = \"calls\",   output_table = \"positions\",   chrs = c(as.character(1:22), paste0(\"chr\", 1:22), \"chrX\", \"chrY\", \"chrM\", paste0(\"Chr\",     1:22), \"ChrX\", \"ChrY\", \"ChrM\"),   samples = NULL,   mod_code = c(\"m\", \"h\", \"m + h\"),   unmod_code = \"-\",   unmod_label = \"c\",   min_num_calls = 1,   temp_dir = tempdir(),   threads = NULL,   memory_limit = NULL,   overwrite = TRUE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"mod_db path .mod.db DuckDB file \"mod_db\" object; connection opened via internal helpers closed return. input_table Name source table containing call-level records (default \"calls\"). Must include least: sample_name, chrom, start, call_code. output_table Name destination positions table create/extend (default \"positions\"). chrs Character vector chromosome/name filters. Rows whose chrom match value retained. Defaults common human aliases (1–22, chrX, chrY, chrM, etc.). samples Optional character vector sample_names include. NULL, samples present input_table processed. mod_code Character vector modification specifications count. entry either single code (e.g., \"m\", \"h\", \"\") \"code1 + code2\" combination. Default: c(\"m\",\"h\",\"m + h\"). unmod_code call code representing unmodified calls (default \"-\"). unmod_label Label used name unmodified columns (default \"c\" yielding c_counts c_frac). min_num_calls Minimum total calls required position written (default 1). temp_dir Directory DuckDB temporary files (default tempdir()). threads Integer DuckDB thread count. NULL, uses internal heuristic (typically --one core). memory_limit DuckDB memory limit string (e.g., \"16384MB\"). NULL, internal heuristic (~80% RAM) used. overwrite TRUE output_table exists, dropped writing.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"(Invisibly) \"mod_db\" object pointing DB file   current_table set output_table. created table columns: sample_name, chrom, start, end,           num_calls, label c(unmod_label, parsed(mod_code)): <label>_counts, <label>_frac.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"function: Opens DB connection configures DuckDB pragmas (temp_directory, threads, memory_limit). Determines list samples process (default, intersection samples). Builds dynamic SQL compute, per sample position (chrom, start):         num_calls, <label>_counts requested code/combination,         <label>_frac = <label>_counts / num_calls. Pre-creates output_table schema appropriate dynamic columns,         inserts rows per sample. end set equal start. Positions num_calls < min_num_calls skipped. Chromosome filtering done SQL.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":"how-modification-codes-work","dir":"Reference","previous_headings":"","what":"How modification codes work","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"Pass mod_code character values (single codes) \"code1 + code2\" build combinations. Column labels derived removing spaces \"+\". example: mod_code = c(\"m\", \"h\", \"m + h\") produces columns m_counts, h_counts, mh_counts mod_code = \"\" produces a_counts unmodified class controlled unmod_code (e.g., \"-\"), column name prefix set unmod_label (default \"c\" c_counts, c_frac).","code":""},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_positions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize per-position methylation calls into a DuckDB table — summarize_mod_positions","text":"","code":"if (FALSE) { # \\dontrun{ # From a calls table, build per-position summaries for default m/h classes: summarize_mod_positions(   mod_db       = \"my_db.mod.db\",   input_table  = \"calls\",   output_table = \"positions\" )  # Restrict to specific samples and chromosomes, require at least 5 calls: summarize_mod_positions(   mod_db       = \"my_db.mod.db\",   samples      = c(\"Cortical_Neurons\",\"Astrocytes\"),   chrs         = c(\"chr1\",\"chrX\"),   min_num_calls = 5 )  # Count a novel code \"a\" and an m+h combination; rename unmodified to 'u': summarize_mod_positions(   mod_db       = \"my_db.mod.db\",   mod_code     = c(\"a\", \"m + h\"),   unmod_code   = \"-\",   unmod_label  = \"u\" )  # Recreate positions table (drop if exists): summarize_mod_positions(   mod_db       = \"my_db.mod.db\",   overwrite    = TRUE ) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_reads.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Reads in a Database — summarize_mod_reads","title":"Summarize Reads in a Database — summarize_mod_reads","text":"function summarizes reads database, filtering processing data based provided key table (given). computes statistics reads number calls, CpG positions, fractions methylation (`m`), hemi-methylation (`h`), total calls. function interacts database generate `reads` table.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_reads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Reads in a Database — summarize_mod_reads","text":"","code":"summarize_mod_reads(   mod_db,   input_calls_table = \"calls\",   output_reads_table = \"reads\",   regions_table = NULL,   min_length = 100,   min_CGs = 5 )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_reads.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Reads in a Database — summarize_mod_reads","text":"mod_db character string specifying path DuckDB database. min_length integer specifying minimum read_length. min_CGs integer specifying minimum number CG sites required read included summary. table_name string specifying user like name called database. Default \"reads\".","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_reads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Reads in a Database — summarize_mod_reads","text":"Invisibly returns database object. function also outputs success message first rows summarized `reads` table.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_reads.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize Reads in a Database — summarize_mod_reads","text":"function connects provided DuckDB database, optionally filters reads based key table, summarizes read data. creates temporary table filtered reads (key table provided) creates summary table called `reads` information total number calls, positions first last CG sites, counts different types calls (`m`, `h`, `-`).","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_reads.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize Reads in a Database — summarize_mod_reads","text":"","code":"#Specify the path to the database  mod_db <- system.file(\"my_data.mod.db\", package = \"ModSeqR\")  region_bed = system.file(\"Islands_hg38_test.csv\", package = \"ModSeqR\")    # Summarize Reads  summarize_mod_reads(mod_db, region_bed) #> Summarizing Reads... #> Error in dbSendQuery(conn, statement, ...): Parser Error: syntax error at or near \"/\" #>  #> LINE 17: FROM /home/runner/work/_temp/Library/ModSeqR/Islands_hg38_test... #>               ^ #>  #> LINE 17: FROM /home/runner/work/_temp/Library/ModSeqR/Islands_hg38_test... #>               ^ #> ℹ Context: rapi_prepare #> ℹ Error type: PARSER"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize methylation by annotated regions — summarize_mod_regions","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"Aggregates call-level rows input_table (typically \"calls\") per-sample region summaries written output_table (default \"regions\"). Regions provided via BED/TSV/CSV file columns chrom, start, end, optional region_name. region function computes: number CpG positions (rows), total calls, per-class counts, per-class fractions.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"","code":"summarize_mod_regions(   mod_db,   input_table = \"calls\",   output_table = \"regions\",   region_file,   join = c(\"inner\", \"left\", \"right\"),   chrs = c(as.character(1:22), paste0(\"chr\", 1:22), \"chrX\", \"chrY\", \"chrM\", paste0(\"Chr\",     1:22), \"ChrX\", \"ChrY\", \"ChrM\"),   samples = NULL,   mod_code = c(\"m\", \"h\", \"m + h\"),   unmod_code = \"-\",   unmod_label = \"c\",   min_num_calls = 1,   temp_dir = tempdir(),   threads = NULL,   memory_limit = NULL,   overwrite = TRUE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"mod_db Path .mod.db DuckDB file \"mod_db\" object. connection opened via internal helpers cleaned return. input_table Source table containing call-level records (default \"calls\"). Must contain least: sample_name, chrom, start, end, call_code. output_table Destination table name (default \"regions\"). region_file BED/TSV/CSV path columns chrom, start, end optional region_name. missing, region_name synthesized \"chrom_start_end\". join Join type positions regions: one \"inner\", \"left\", \"right\" (default \"inner\"). chrs Character vector chromosome filters; rows whose chrom match value retained. Defaults common human aliases (1–22, chrX, chrY, chrM, …). samples Optional character vector sample_names include. NULL, samples present input_table processed. mod_code Character vector modification specs count (single codes \"code1 + code2\" combinations). Default c(\"m\",\"h\",\"m + h\"). unmod_code Call code representing unmodified (default \"-\"). unmod_label Label used name unmodified columns (default \"c\"). min_num_calls Minimum total calls required region level written (default 1). Regions threshold skipped. temp_dir Directory DuckDB temporary files (default tempdir()). threads Integer DuckDB thread count. NULL, internal heuristic (typically --one core) used. memory_limit DuckDB memory limit string (e.g. \"16384MB\"). NULL, internal heuristic (~80% RAM) used. overwrite TRUE output_table exists, dropped writing.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"(Invisibly) \"mod_db\" object pointing DB file   current_table set output_table. created table columns: sample_name, region_name, chrom, start, end,           num_CpGs, num_calls, label c(unmod_label, parsed(mod_code)):           <label>_counts, <label>_frac.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"function: Reads region_file (CSV/TSV/BED) normalizes columns. region_name         absent, synthesized. Basic chromosome-prefix harmonization performed         DB positions annotation disagree presence \"chr\" prefix. Configures DuckDB pragmas (temp_directory, threads, memory_limit). Builds per-position counts (one row per sample_name, chrom, start)         requested classes (<label>_counts, plus fractions later). Joins positions regions using chosen join type aggregates per region:         num_CpGs, num_calls, <label>_counts,         <label>_frac = <label>_counts / num_calls.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":"how-modification-codes-work","dir":"Reference","previous_headings":"","what":"How modification codes work","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"Pass mod_code single codes (e.g. \"m\", \"h\", \"\") combinations \"+\" (e.g. \"m + h\"). Labels created removing spaces \"+\" (e.g. \"m + h\" → \"mh\"). label table includes <label>_counts <label>_frac. unmodified class defined unmod_code (default \"-\"), named using unmod_label (default \"c\" → c_counts, c_frac).","code":""},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_regions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize methylation by annotated regions — summarize_mod_regions","text":"","code":"if (FALSE) { # \\dontrun{ # Default m/h summary by regions summarize_mod_regions(   mod_db      = \"my_db.mod.db\",   region_file = \"islands_hg38.bed\" )  # Novel 'a' code and m+h combination, left join to keep empty regions summarize_mod_regions(   mod_db      = \"my_db.mod.db\",   region_file = \"islands_hg38.csv\",   mod_code    = c(\"a\",\"m + h\"),   join        = \"left\",   min_num_calls = 10 ) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize methylation in sliding windows — summarize_mod_windows","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"Aggregates call-level rows input_table (typically \"calls\") per-sample window summaries written output_table (default \"windows\"). Windows created using tiling + offsets strategy every start position assigned one windows depending step_size. window function computes: total CpG sites, total calls, per-class counts, per-class fractions.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"","code":"summarize_mod_windows(   mod_db,   input_table = \"calls\",   output_table = \"windows\",   window_size = 1000,   step_size = 10,   chrs = c(as.character(1:22), paste0(\"chr\", 1:22), \"chrX\", \"chrY\", \"chrM\", paste0(\"Chr\",     1:22), \"ChrX\", \"ChrY\", \"ChrM\"),   samples = NULL,   mod_code = c(\"m\", \"h\", \"m + h\"),   unmod_code = \"-\",   unmod_label = \"c\",   min_num_calls = 1,   temp_dir = tempdir(),   threads = NULL,   memory_limit = NULL,   overwrite = TRUE )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"mod_db Path .mod.db DuckDB file \"mod_db\" object. connection opened via internal helpers closed/cleaned return. input_table Source table containing call-level records (default \"calls\"). Must contain least: sample_name, chrom, start, call_code. output_table Destination window table name (default \"windows\"). window_size Integer window width bases (default 1000). step_size Step, bases, used create staggered window offsets (default 10). Offsets seq(1, window_size - 1, = step_size). chrs Character vector chromosome filters; rows whose chrom match value retained. Defaults common human aliases (1–22, chrX, chrY, chrM, …). samples Optional character vector sample_names include. NULL, samples present input_table processed. mod_code Character vector modification specs count (single codes \"code1 + code2\" combinations). Default c(\"m\",\"h\",\"m + h\"). unmod_code Call code representing unmodified (default \"-\"). unmod_label Label used name unmodified columns (default \"c\"). min_num_calls Minimum total calls required window written (default 1). Windows threshold skipped. temp_dir Directory DuckDB temporary files (default tempdir()). threads Integer DuckDB thread count. NULL, internal heuristic (typically --one core) used. memory_limit DuckDB memory limit string (e.g. \"16384MB\"). NULL, internal heuristic (~80% RAM) used. overwrite TRUE output_table exists, dropped writing.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"(Invisibly) \"mod_db\" object pointing DB file   current_table set output_table. created table columns: sample_name, chrom, start, end,           num_CpGs, num_calls, label c(unmod_label, parsed(mod_code)):           <label>_counts, <label>_frac.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"sample, function first aggregates per-position counts input_table (num_calls plus dynamically generated <label>_counts per mod_code/unmod_code). creates sliding windows assigning position window start computed : $$temp\\_start = start - ((start - offset) \\bmod window\\_size).$$ offset seq(1, window_size - 1, = step_size), sums counts [temp_start, temp_start + window_size - 1] writes: num_CpGs: number positions aggregated window num_calls: sum num_calls <label>_counts: summed counts label <label>_frac: <label>_counts / num_calls (NULL num_calls == 0) Resource pragmas (temp_directory, threads, memory_limit) set via internal heuristics unless overridden.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":"how-modification-codes-work","dir":"Reference","previous_headings":"","what":"How modification codes work","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"Pass mod_code single codes (e.g. \"m\", \"h\", \"\") combinations \"+\" (e.g. \"m + h\"). Labels created removing spaces \"+\" (e.g. \"m + h\" → \"mh\"). label table includes <label>_counts <label>_frac. unmodified class defined unmod_code (default \"-\"), named using unmod_label (default \"c\" → c_counts, c_frac).","code":""},{"path":[]},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/summarize_mod_windows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize methylation in sliding windows — summarize_mod_windows","text":"","code":"if (FALSE) { # \\dontrun{ # Default m/h windows (1kb windows, 10bp staggered offsets) summarize_mod_windows(\"my_db.mod.db\")  # Custom mod codes with a novel 'a' code and stricter filtering summarize_mod_windows(   mod_db        = \"my_db.mod.db\",   mod_code      = c(\"a\", \"m + h\"),   min_num_calls = 25,   window_size   = 2000,   step_size     = 20 )  # Limit to selected samples and chromosomes; recreate table if present summarize_mod_windows(   mod_db       = \"my_db.mod.db\",   samples      = c(\"Astrocytes\",\"Blood_Plasma\"),   chrs         = c(\"chr1\",\"chrX\"),   overwrite    = TRUE ) } # }"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/trim_mod_reads.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim methylation calls at the read ends in a mod database — trim_mod_reads","title":"Trim methylation calls at the read ends in a mod database — trim_mod_reads","text":"Creates new table mod database keeps methylation calls within central fraction read, optionally trimming start, end, . Trimming expressed fraction read length applied via SQL filters `read_position`.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/trim_mod_reads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim methylation calls at the read ends in a mod database — trim_mod_reads","text":"","code":"trim_mod_reads(   mod_db,   by_frac = 0.1,   trim_start = FALSE,   trim_end = TRUE,   input_table = \"calls\",   output_table = \"calls_trimmed\" )"},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/trim_mod_reads.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim methylation calls at the read ends in a mod database — trim_mod_reads","text":"mod_db object identifying mod database, accepted ModSeqR:::.modhelper_connectDB() (e.g. file path existing mod database object). by_frac Numeric scalar 0 1 (exclusive) giving fraction read length trim enabled end. example, by_frac = 0.1 trims 10% read length start /end. trim_start Logical; whether trim start (low read_position) read. trim_end Logical; whether trim end (high read_position) read. input_table Character scalar; name input table containing methylation calls (default \"calls\"). Must contain least read_position read_length columns. output_table Character scalar; name output table create/overwrite trimmed calls (default \"calls_trimmed\").","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/trim_mod_reads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Trim methylation calls at the read ends in a mod database — trim_mod_reads","text":"Invisibly returns updated mod_db object, current_table set output_table. function called side effects creating/replacing trimmed table database.","code":""},{"path":"https://wasatch-biolabs-bfx.github.io/ModSeqR/reference/trim_mod_reads.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Trim methylation calls at the read ends in a mod database — trim_mod_reads","text":"read length `L` `by_frac = f`: trim_start = TRUE, positions         read_position < L * f dropped. trim_end   = TRUE, positions         read_position >= L * (1 - f) dropped. example, read_length = 100 by_frac = 0.1, positions 0–9 /90–99 trimmed depending end(s) enabled. function issues CREATE REPLACE TABLE SQL statement mod database. resulting table contains subset rows input_table read positions fall within untrimmed interior region defined by_frac, trim_start, trim_end. by_frac strictly 0 1, error thrown. trim_start trim_end FALSE, function also errors, nothing trim. success, mod_db$current_table updated output_table short timing message printed.","code":""},{"path":[]}]
